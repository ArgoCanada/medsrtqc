<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>medsrtqc &mdash; MEDS Realtime QC  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Core framework" href="core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            MEDS Realtime QC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="qc.html">Quality Control Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="nc.html">NetCDF IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="vms.html">VMS IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive.html">Interactive helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resource files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">MEDS Realtime QC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">medsrtqc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="medsrtqc">
<h1>medsrtqc<a class="headerlink" href="#medsrtqc" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://github.com/ArgoCanada/medsrtqc/actions/workflows/check.yaml"><img alt="Check" src="https://github.com/ArgoCanada/medsrtqc/actions/workflows/check.yaml/badge.svg" /></a> <a class="reference external" href="https://codecov.io/gh/ArgoCanada/medsrtqc?branch=master"><img alt="Codecov test coverage" src="https://codecov.io/gh/ArgoCanada/medsrtqc/branch/master/graph/badge.svg" /></a></p>
<p>A possible container for MEDS real-time quality control code.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>You can install the <code class="docutils literal notranslate"><span class="pre">medsrtqc</span></code> package using <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/ArgoCanada/medsrtqc.git
</pre></div>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>QC code in <code class="docutils literal notranslate"><span class="pre">medsrtqc</span></code> is built on the <code class="docutils literal notranslate"><span class="pre">Trace</span></code> and <code class="docutils literal notranslate"><span class="pre">Profile</span></code>
classes. A <code class="docutils literal notranslate"><span class="pre">Profile</span></code> is roughly what you would get from a single-cycle
Argo NetCDF file. The <code class="docutils literal notranslate"><span class="pre">Profile</span></code> can be subclassed to abstract away the
storage details such that QC code can be tested on NetCDF files but run
with an arbitrary storage backend. You can get started with the NetCDF
backend in a few lines:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">medsrtqc.nc</span> <span class="kn">import</span> <span class="n">read_nc_profile</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://data-argo.ifremer.fr/dac/coriolis/6904117/profiles/R6904117_085.nc&#39;</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">read_nc_profile</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">profile</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Trace</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">13.3847</span><span class="p">,</span> <span class="mf">12.9791</span><span class="p">,</span> <span class="mf">12.3505</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="mf">7.2176</span><span class="p">,</span> <span class="mf">7.2166</span><span class="p">,</span> <span class="mf">7.2168</span><span class="p">],</span>
    <span class="n">qc</span><span class="o">=</span><span class="p">[</span><span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">],</span>
    <span class="n">adjusted</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted_qc</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted_error</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">pres</span><span class="o">=</span><span class="p">[</span><span class="mf">5.27</span><span class="p">,</span> <span class="mf">5.79</span><span class="p">,</span> <span class="mf">6.48</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="mf">201.5</span><span class="p">,</span> <span class="mf">202.54</span><span class="p">,</span> <span class="mf">203.5</span><span class="p">],</span>
    <span class="n">mtime</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.0010303024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0011113208</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012386356</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.03871549</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03886595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.039051134</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can specify multiple files to combine e.g. a core and a BGC file
that represent the same <code class="docutils literal notranslate"><span class="pre">Profile</span></code> but are split into two files for
historical and/or logistical reasons.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">url_bgc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/R&#39;</span><span class="p">,</span> <span class="s1">&#39;/BD&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">read_nc_profile</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">url_bgc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;CHLA&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">profile</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Trace</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5622</span><span class="p">,</span> <span class="mf">1.533</span><span class="p">,</span> <span class="mf">1.533</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="mf">0.3577</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">,</span> <span class="mf">0.3504</span><span class="p">],</span>
    <span class="n">qc</span><span class="o">=</span><span class="p">[</span><span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">],</span>
    <span class="n">adjusted</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7811</span><span class="p">,</span> <span class="mf">0.7665</span><span class="p">,</span> <span class="mf">0.7665</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="mf">0.17885</span><span class="p">,</span> <span class="mf">0.1825</span><span class="p">,</span> <span class="mf">0.1752</span><span class="p">],</span>
    <span class="n">adjusted_qc</span><span class="o">=</span><span class="p">[</span><span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">],</span>
    <span class="n">adjusted_error</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">pres</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="mf">204.1</span><span class="p">,</span> <span class="mf">204.0</span><span class="p">,</span> <span class="mf">204.0</span><span class="p">],</span>
    <span class="n">mtime</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">1267</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">Trace</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">13.3847</span><span class="p">,</span> <span class="mf">12.9791</span><span class="p">,</span> <span class="mf">12.3505</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="mf">7.2176</span><span class="p">,</span> <span class="mf">7.2166</span><span class="p">,</span> <span class="mf">7.2168</span><span class="p">],</span>
    <span class="n">qc</span><span class="o">=</span><span class="p">[</span><span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">],</span>
    <span class="n">adjusted</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted_qc</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted_error</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">pres</span><span class="o">=</span><span class="p">[</span><span class="mf">5.27</span><span class="p">,</span> <span class="mf">5.79</span><span class="p">,</span> <span class="mf">6.48</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="mf">201.5</span><span class="p">,</span> <span class="mf">202.54</span><span class="p">,</span> <span class="mf">203.5</span><span class="p">],</span>
    <span class="n">mtime</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.0010303024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0011113208</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0012386356</span><span class="p">,</span> <span class="p">[</span><span class="mi">194</span> <span class="n">values</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.03871549</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03886595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.039051134</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can use the interactive plotter to quickly visualize all or part of
a profile:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">medsrtqc.interactive</span> <span class="kn">import</span> <span class="n">plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="n">profile</span><span class="o">.</span><span class="n">keys</span><span class="p">()[:</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/README_5_0.png" src="_images/README_5_0.png" />
<p>You can use the <code class="docutils literal notranslate"><span class="pre">Trace</span></code> and <code class="docutils literal notranslate"><span class="pre">Profile</span></code> classes directly to generate
unit test data with known statistical properties:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">medsrtqc.core</span> <span class="kn">import</span> <span class="n">Trace</span><span class="p">,</span> <span class="n">Profile</span>
<span class="n">Trace</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">adjusted</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">pres</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Trace</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
    <span class="n">qc</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
    <span class="n">adjusted_qc</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">adjusted_error</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">],</span>
    <span class="n">pres</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
    <span class="n">mtime</span><span class="o">=</span><span class="p">[</span><span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">,</span> <span class="n">masked</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="qc-a-vms-dat-file">
<h2>QC A VMS .DAT file<a class="headerlink" href="#qc-a-vms-dat-file" title="Permalink to this heading"></a></h2>
<p>This doesn’t quote work (it looks like the pressure QC flags aren’t
updating) but it’s close!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">medsrtqc.vms</span> <span class="kn">import</span> <span class="n">read_vms_profiles</span><span class="p">,</span> <span class="n">write_vms_profiles</span>
<span class="kn">from</span> <span class="nn">medsrtqc.resources</span> <span class="kn">import</span> <span class="n">resource_path</span>
<span class="kn">from</span> <span class="nn">medsrtqc.qc.flag</span> <span class="kn">import</span> <span class="n">Flag</span>
<span class="kn">from</span> <span class="nn">medsrtqc.qc.named_tests</span> <span class="kn">import</span> <span class="n">PressureIncreasingTest</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># load file</span>
<span class="n">profs</span> <span class="o">=</span> <span class="n">read_vms_profiles</span><span class="p">(</span><span class="n">resource_path</span><span class="p">(</span><span class="s1">&#39;BINARY_VMS.DAT&#39;</span><span class="p">))</span>

<span class="c1"># run test on a prof that will fail</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">PressureIncreasingTest</span><span class="p">()</span>
<span class="n">prof</span> <span class="o">=</span> <span class="n">profs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">prof</span><span class="p">)</span>  <span class="c1"># False</span>

<span class="c1"># check result (should have one point marked as bad)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">prof</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;PRES&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PSAL&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;PRES&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PSAL&#39;</span><span class="p">)):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="n">bad</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">qc</span> <span class="o">==</span> <span class="n">Flag</span><span class="o">.</span><span class="n">BAD</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">bad</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">bad</span><span class="p">])</span>

<span class="c1"># if you want to write changes to disk</span>
<span class="c1"># profs[0] = prof</span>
<span class="c1"># write_vms_profiles(profs, &#39;output_file.DAT&#39;)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;BINARY_VMS.DAT&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">resource</span> <span class="n">within</span> <span class="n">the</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">medsrtqc</span><span class="o">/</span><span class="n">medsrtqc</span><span class="o">/</span><span class="n">config</span> <span class="n">directory</span><span class="o">.</span> <span class="n">Checking</span> <span class="n">resources</span><span class="o">...</span>
</pre></div>
</div>
<img alt="_images/README_9_1.png" src="_images/README_9_1.png" />
</section>
<section id="qc-a-netcdf-file">
<h2>QC a NetCDF file<a class="headerlink" href="#qc-a-netcdf-file" title="Permalink to this heading"></a></h2>
<p>This should work but I haven’t tested properly yet.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span> <span class="o">=</span> <span class="n">read_nc_profile</span><span class="p">(</span><span class="n">resource_path</span><span class="p">(</span><span class="s1">&#39;R6904117_085.nc&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">PressureIncreasingTest</span><span class="p">()</span>
<span class="n">test</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">prof</span><span class="p">)</span>
<span class="c1"># prof.close() if you want to write changes to disk</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;R6904117_085.nc&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">resource</span> <span class="n">within</span> <span class="n">the</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">medsrtqc</span><span class="o">/</span><span class="n">medsrtqc</span><span class="o">/</span><span class="n">config</span> <span class="n">directory</span><span class="o">.</span> <span class="n">Checking</span> <span class="n">resources</span><span class="o">...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core.html#medsrtqc.core.Profile"><code class="docutils literal notranslate"><span class="pre">Profile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#medsrtqc.core.Trace"><code class="docutils literal notranslate"><span class="pre">Trace</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qc.html">Quality Control Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="qc.html#module-medsrtqc.qc.operation">Common classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="qc.html#module-medsrtqc.qc.named_tests">Named Argo QC tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nc.html">NetCDF IO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nc.html#medsrtqc.nc.read_nc_profile"><code class="docutils literal notranslate"><span class="pre">read_nc_profile()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nc.html#medsrtqc.nc.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="nc.html#medsrtqc.nc.NetCDFProfile"><code class="docutils literal notranslate"><span class="pre">NetCDFProfile</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vms.html">VMS IO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vms.html#medsrtqc.vms.read_vms_profiles"><code class="docutils literal notranslate"><span class="pre">read_vms_profiles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="vms.html#medsrtqc.vms.write_vms_profiles"><code class="docutils literal notranslate"><span class="pre">write_vms_profiles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="vms.html#medsrtqc.vms.VMSProfile"><code class="docutils literal notranslate"><span class="pre">VMSProfile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="vms.html#module-medsrtqc.vms.enc">Low-level VMS IO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interactive.html">Interactive helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interactive.html#medsrtqc.interactive.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive.html#medsrtqc.interactive.plot_trace"><code class="docutils literal notranslate"><span class="pre">plot_trace()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="interactive.html#medsrtqc.interactive.plot_profile"><code class="docutils literal notranslate"><span class="pre">plot_profile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resource files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="resources.html#medsrtqc.resources.resource_path"><code class="docutils literal notranslate"><span class="pre">resource_path()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="core.html" class="btn btn-neutral float-right" title="Core framework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Dewey Dunnington.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>